<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Student Portal - Xem ƒëi·ªÉm Blockchain</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.jsdelivr.net/npm/@metamask/eth-sig-util@7.0.0/dist/index.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      padding: 30px;
    }
    h1 {
      color: #333;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .subtitle {
      color: #666;
      margin-bottom: 30px;
      font-size: 14px;
    }
    .header-section {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 30px;
      border-left: 4px solid #667eea;
    }
    button {
      background: #667eea;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      margin: 10px 5px 10px 0;
      transition: background 0.3s;
    }
    button:hover {
      background: #5568d3;
    }
    button.success {
      background: #28a745;
    }
    button.success:hover {
      background: #218838;
    }
    .info-box {
      background: #e3f2fd;
      border-left: 4px solid #2196F3;
      padding: 15px;
      margin: 20px 0;
      border-radius: 5px;
      font-size: 14px;
      color: #0d47a1;
    }
    .success-box {
      background: #d4edda;
      border-left: 4px solid #28a745;
      padding: 15px;
      margin: 20px 0;
      border-radius: 5px;
      font-size: 14px;
      color: #155724;
    }
    .error-box {
      background: #f8d7da;
      border-left: 4px solid #dc3545;
      padding: 15px;
      margin: 20px 0;
      border-radius: 5px;
      font-size: 14px;
      color: #721c24;
    }
    .warning-box {
      background: #fff3cd;
      border-left: 4px solid #ffc107;
      padding: 15px;
      margin: 20px 0;
      border-radius: 5px;
      font-size: 14px;
      color: #856404;
    }
    .summary-section {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-radius: 10px;
      padding: 30px;
      margin: 30px 0;
      box-shadow: 0 5px 20px rgba(0,0,0,0.2);
    }
    .summary-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .summary-card {
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(10px);
      border-radius: 8px;
      padding: 20px;
      text-align: center;
      border: 1px solid rgba(255,255,255,0.2);
    }
    .summary-value {
      font-size: 32px;
      font-weight: bold;
      margin: 10px 0;
    }
    .summary-label {
      font-size: 14px;
      opacity: 0.9;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .progress-bar {
      background: rgba(255,255,255,0.2);
      border-radius: 10px;
      height: 20px;
      margin: 10px 0;
      overflow: hidden;
    }
    .progress-fill {
      background: linear-gradient(90deg, #28a745, #20c997);
      height: 100%;
      transition: width 0.5s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: bold;
    }
    .grade-distribution {
      display: flex;
      gap: 10px;
      margin-top: 15px;
      flex-wrap: wrap;
    }
    .grade-badge {
      background: rgba(255,255,255,0.2);
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 13px;
      border: 1px solid rgba(255,255,255,0.3);
    }
    .semester-card {
      background: white;
      border: 2px solid #667eea;
      border-radius: 10px;
      padding: 25px;
      margin: 20px 0;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .semester-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 2px solid #e9ecef;
    }
    .semester-title {
      font-size: 20px;
      font-weight: bold;
      color: #667eea;
    }
    .semester-meta {
      font-size: 13px;
      color: #666;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 15px 0;
    }
    th, td {
      padding: 12px;
      text-align: left;
      border: 1px solid #ddd;
    }
    th {
      background: #667eea;
      color: white;
      font-weight: 600;
    }
    tr:nth-child(even) {
      background: #f8f9fa;
    }
    .loading {
      text-align: center;
      padding: 40px;
      color: #666;
    }
    .spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #667eea;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .graduate-section {
      background: #fff3cd;
      border: 2px solid #ffc107;
      border-radius: 10px;
      padding: 20px;
      margin: 30px 0;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üéì Student Portal - Xem ƒëi·ªÉm Blockchain</h1>
    <p class="subtitle">Tra c·ª©u ƒëi·ªÉm h·ªçc t·∫≠p v√† qu√° tr√¨nh h·ªçc t·∫≠p t·ª´ Blockchain</p>

    <!-- STATUS MESSAGE -->
    <div id="status" style="margin-bottom: 15px;"></div>

    <!-- TH√îNG TIN SINH VI√äN -->
    <div id="studentInfoSection" style="display: none;" class="info-box">
      <h3 style="color: #0d47a1; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
        üë§ Th√¥ng tin sinh vi√™n
      </h3>
      <div id="studentInfoContent">
        <p style="color: #666; font-style: italic;">Th√¥ng tin s·∫Ω hi·ªÉn th·ªã sau khi tra c·ª©u</p>
      </div>
    </div>

    <!-- T·ªîNG K·∫æT H·ªåC T·∫¨P -->
    <div class="summary-section" id="summarySection" style="display: none;">
      <h2 style="margin-bottom: 10px;">üìä T·ªïng k·∫øt h·ªçc t·∫≠p</h2>
      <p style="opacity: 0.9; margin-bottom: 20px;">Th√¥ng tin t·ªïng h·ª£p to√†n kh√≥a h·ªçc</p>
      
      <div class="summary-grid">
        <div class="summary-card">
          <div class="summary-label">GPA T√≠ch l≈©y</div>
          <div class="summary-value" id="overallGPA">0.00</div>
          <div style="font-size: 12px; margin-top: 5px;">H·ªá 10 / H·ªá 4</div>
        </div>
        
        <div class="summary-card">
          <div class="summary-label">T√≠n ch·ªâ t√≠ch l≈©y</div>
          <div class="summary-value" id="totalCredits">0</div>
          <div class="progress-bar">
            <div class="progress-fill" id="creditProgress" style="width: 0%;">0%</div>
          </div>
          <div style="font-size: 12px; margin-top: 5px;">Y√™u c·∫ßu: 156 t√≠n ch·ªâ</div>
        </div>
        
        <div class="summary-card">
          <div class="summary-label">T·ªïng s·ªë m√¥n</div>
          <div class="summary-value" id="totalCourses">0</div>
          <div style="font-size: 12px; margin-top: 5px;">
            <span id="passedCourses" style="color: #20c997;">0 PASS</span> / 
            <span id="failedCourses" style="color: #ff6b6b;">0 FAIL</span>
          </div>
        </div>
        
        <div class="summary-card">
          <div class="summary-label">S·ªë h·ªçc k·ª≥</div>
          <div class="summary-value" id="totalSemesters">0</div>
          <div style="font-size: 12px; margin-top: 5px;">ƒê√£ ho√†n th√†nh</div>
        </div>
      </div>

      <div style="margin-top: 25px;">
        <h3 style="font-size: 16px; margin-bottom: 10px;">üìà Ph√¢n b·ªë ƒëi·ªÉm</h3>
        <div class="grade-distribution">
          <div class="grade-badge">
            <strong id="gradeA">0</strong> m√¥n A (9.0-10)
          </div>
          <div class="grade-badge">
            <strong id="gradeB">0</strong> m√¥n B+/B (7.0-8.9)
          </div>
          <div class="grade-badge">
            <strong id="gradeC">0</strong> m√¥n C+/C (5.5-6.9)
          </div>
          <div class="grade-badge">
            <strong id="gradeD">0</strong> m√¥n D+/D (4.0-5.4)
          </div>
          <div class="grade-badge">
            <strong id="gradeF">0</strong> m√¥n F (<4.0)
          </div>
        </div>
      </div>

      <div style="margin-top: 25px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.2);">
        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;">
          <div>
            <strong>X·∫øp lo·∫°i h·ªçc l·ª±c:</strong> 
            <span id="academicRank" style="font-size: 18px; margin-left: 10px;">-</span>
          </div>
          <div>
            <strong>Tr·∫°ng th√°i:</strong> 
            <span id="studyStatus" style="font-size: 18px; margin-left: 10px;">-</span>
          </div>
        </div>
      </div>
    </div>

    <!-- DANH S√ÅCH H·ªåC K·ª≤ -->
    <div>
      <h2 style="color: #333; margin-bottom: 15px;">üìö ƒêi·ªÉm c√°c h·ªçc k·ª≥ ƒë√£ ho√†n th√†nh</h2>
      
      <div style="background: #e7f3ff; border-left: 4px solid #2196F3; padding: 15px; margin-bottom: 20px; border-radius: 5px;">
        <h4 style="color: #0d47a1; margin-bottom: 10px;">üìå Quy t·∫Øc t√≠nh ƒëi·ªÉm m√¥n h·ªçc l·∫°i:</h4>
        <ul style="margin-left: 20px; color: #333; line-height: 1.8;">
          <li><strong>T√≠n ch·ªâ:</strong> M√¥n h·ªçc l·∫°i ch·ªâ t√≠nh <strong>1 l·∫ßn t√≠n ch·ªâ</strong> (kh√¥ng nh√¢n s·ªë l·∫ßn h·ªçc)</li>
          <li><strong>S·ªë m√¥n:</strong> M√¥n h·ªçc l·∫°i ch·ªâ t√≠nh <strong>1 m√¥n</strong> trong t·ªïng k·∫øt</li>
          <li><strong>ƒêi·ªÉm s·ªë:</strong> L·∫•y <strong>ƒëi·ªÉm cao nh·∫•t</strong> trong c√°c l·∫ßn h·ªçc ƒë·ªÉ t√≠nh GPA</li>
          <li><strong>M√¥n ch∆∞a ho√†n th√†nh:</strong> T·∫•t c·∫£ m√¥n c√≥ ƒëi·ªÉm < 1.0 (h·ªá 4) - bao g·ªìm c·∫£ m√¥n b·∫Øt bu·ªôc v√† t·ª± ch·ªçn</li>
          <li><strong>M√¥n ƒë√£ h·ªçc l·∫°i v√† ƒë·∫°t:</strong> Kh√¥ng t√≠nh v√†o m√¥n ch∆∞a ho√†n th√†nh n·ªØa</li>
          <li><strong>S·ªë h·ªçc k·ª≥ t·ªëi ƒëa:</strong> 26 h·ªçc k·ª≥ (kh√¥ng ph·∫£i 9)</li>
          <li><strong>Hi·ªÉn th·ªã:</strong> 
            <span style="display: inline-block; width: 15px; height: 10px; background: #d4edda; border: 1px solid #c3e6cb; margin: 0 5px;"></span> Xanh = K·∫øt qu·∫£ ƒë∆∞·ª£c c√¥ng nh·∫≠n | 
            <span style="display: inline-block; width: 15px; height: 10px; background: #fff3cd; border: 1px solid #ffeaa7; margin: 0 5px;"></span> V√†ng = M√¥n h·ªçc l·∫°i kh√¥ng t√≠nh
          </li>
        </ul>
      </div>
      
      <button id="btnLoadGrades" class="success">üìä T·∫£i ƒëi·ªÉm t·∫•t c·∫£ h·ªçc k·ª≥</button>
      <button id="btnCheckGraduation" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">üéì ƒêƒÉng k√Ω x√©t t·ªët nghi·ªáp</button>
      
      <div id="loadingIndicator" style="display: none;">
        <div class="spinner"></div>
        <p class="loading">ƒêang t·∫£i d·ªØ li·ªáu t·ª´ blockchain...</p>
      </div>
      
      <div id="semestersContainer"></div>
    </div>

    <!-- K·∫æT QU·∫¢ X√âT T·ªêT NGHI·ªÜP -->
    <div id="graduationResult" style="display: none; margin-top: 30px;">
    </div>


  </div>

  <!-- Web3.js -->
  <script src="https://cdn.jsdelivr.net/npm/web3@1.10.4/dist/web3.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
  <script src="auth.js"></script>
  <script src="student.js?t=1763296049"></script>
</body>
</html>